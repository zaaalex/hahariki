{"version":3,"file":"main-page.bundle.js","sources":["../src/main-page.js"],"sourcesContent":["import { Type, Tag, Loc, Event } from 'main.core';\n\ntype MainPageParams = {\n\tuserId: number,\n\tcontainer: HTMLElement,\n}\n\nexport class MainPage\n{\n\t#userId: number;\n\t#container: HTMLElement;\n\n\tconstructor(params: MainPageParams)\n\t{\n\t\tif (!Type.isDomNode(params.container))\n\t\t{\n\t\t\tthrow new Error('HTMLElement for render not found');\n\t\t}\n\n\t\tif (!Type.isNumber(params.userId))\n\t\t{\n\t\t\tthrow new TypeError('The userId must be a number');\n\t\t}\n\n\t\tthis.#userId = params.userId;\n\t\tthis.#container = params.container;\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.#container.append(this.#showMainPage());\n\t}\n\n\t#showMainPage(): HTMLElement\n\t{\n\t\tconst { node, btn } = Tag.render`\n\t\t\t<div class=\"\" ref=\"node\">\n\t\t\t\t<button class=\"hahariki_create-lobby-btn button is-link is-light\" ref=\"btn\">\n\t\t\t\t\t${Loc.getMessage('HAHARIKI__CREATE_BTN_TEXT')}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(\n\t\t\tbtn,\n\t\t\t'click',\n\t\t\tthis.onReloadButtonClick.bind(this),\n\t\t);\n\n\t\treturn node;\n\t}\n\n\tasync onReloadButtonClick(): void\n\t{\n\t\tconst lobbyParams = await BX.ajax.runAction(\n\t\t\t'bitrix:hahariki.Lobby.createLobby',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tcreatorId: this.#userId,\n\t\t\t\t},\n\t\t\t},\n\t\t)\n\t\t\t.then((response) => response.data)\n\t\t;\n\n\t\tif (!Type.isNil(lobbyParams.errors))\n\t\t{\n\t\t\tlobbyParams.errors.forEach((error: string) => this.#container.append(\n\t\t\t\tTag.render`<div>${error}</div>`,\n\t\t\t));\n\t\t}\n\n\t\twindow.location.href = lobbyParams.lobbyHref;\n\t}\n}\n"],"names":["MainPage","constructor","params","Type","isDomNode","container","Error","isNumber","userId","TypeError","show","append","onReloadButtonClick","lobbyParams","BX","ajax","runAction","data","creatorId","then","response","isNil","errors","forEach","error","Tag","render","window","location","href","lobbyHref","node","btn","Loc","getMessage","Event","bind"],"mappings":";;;;;;;;AAAA,CAAkD;CAAA;CAAA;AAOlD,CAAO,MAAMA,QAAQ,CACrB;GAICC,WAAW,CAACC,MAAsB,EAClC;KAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KACC,IAAI,CAACC,cAAI,CAACC,SAAS,CAACF,MAAM,CAACG,SAAS,CAAC,EACrC;OACC,MAAM,IAAIC,KAAK,CAAC,kCAAkC,CAAC;;KAGpD,IAAI,CAACH,cAAI,CAACI,QAAQ,CAACL,MAAM,CAACM,MAAM,CAAC,EACjC;OACC,MAAM,IAAIC,SAAS,CAAC,6BAA6B,CAAC;;KAGnD,4CAAI,sBAAWP,MAAM,CAACM,MAAM;KAC5B,4CAAI,4BAAcN,MAAM,CAACG,SAAS;;GAGnCK,IAAI,GACJ;KACC,4CAAI,0BAAYC,MAAM,yCAAC,IAAI,kCAAiB;;GAsB7C,MAAMC,mBAAmB,GACzB;KACC,MAAMC,WAAW,GAAG,MAAMC,EAAE,CAACC,IAAI,CAACC,SAAS,CAC1C,mCAAmC,EACnC;OACCC,IAAI,EAAE;SACLC,SAAS,0CAAE,IAAI;;MAEhB,CACD,CACCC,IAAI,CAAEC,QAAQ,IAAKA,QAAQ,CAACH,IAAI,CAAC;KAGnC,IAAI,CAACd,cAAI,CAACkB,KAAK,CAACR,WAAW,CAACS,MAAM,CAAC,EACnC;OACCT,WAAW,CAACS,MAAM,CAACC,OAAO,CAAEC,KAAa,IAAK,4CAAI,0BAAYb,MAAM,CACnEc,aAAG,CAACC,MAAM,cAAC,QAAK,CAAQ,QAAM,GAAZF,KAAK,EACvB,CAAC;;KAGHG,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAGhB,WAAW,CAACiB,SAAS;;CAE9C;CAAC,0BAxCA;GACC,MAAM;KAAEC,IAAI;KAAEC;IAAK,GAAGP,aAAG,CAACC,MAAM,gBAAC;;;OAG9B,CAA8C;;;GAGjD,GAHKO,aAAG,CAACC,UAAU,CAAC,2BAA2B,CAAC,CAG/C;GAEDC,eAAK,CAACC,IAAI,CACTJ,GAAG,EACH,OAAO,EACP,IAAI,CAACpB,mBAAmB,CAACwB,IAAI,CAAC,IAAI,CAAC,CACnC;GAED,OAAOL,IAAI;CACZ;;;;;;;;"}